

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/notebook.png">
  <link rel="icon" href="/img/notebook.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="mush">
  <meta name="keywords" content="">
  
    <meta name="description" content="OpenStack M版搭建 密码表：(密码均为密码名称)   密码名称 描述    数据库密码(不能使用变量) 数据库的root密码   ADMIN_PASS admin 用户密码   CEILOMETER_DBPASS Telemetry 服务的数据库密码   CEILOMETER_PASS Telemetry 服务的 ceilometer 用户密码   CINDER_DBPASS 块设备存储">
<meta property="og:type" content="article">
<meta property="og:title" content="openstack-Mitaka">
<meta property="og:url" content="http://example.com/2022/04/17/openstack-Mitaka/index.html">
<meta property="og:site_name" content="mush">
<meta property="og:description" content="OpenStack M版搭建 密码表：(密码均为密码名称)   密码名称 描述    数据库密码(不能使用变量) 数据库的root密码   ADMIN_PASS admin 用户密码   CEILOMETER_DBPASS Telemetry 服务的数据库密码   CEILOMETER_PASS Telemetry 服务的 ceilometer 用户密码   CINDER_DBPASS 块设备存储">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.bmp.ovh/imgs/2022/04/17/3f71c9177e94cb22.png">
<meta property="article:published_time" content="2022-04-17T06:47:38.000Z">
<meta property="article:modified_time" content="2024-01-12T08:18:20.227Z">
<meta property="article:author" content="mush">
<meta property="article:tag" content="openstack-M">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.bmp.ovh/imgs/2022/04/17/3f71c9177e94cb22.png">
  
  
  <title>openstack-Mitaka - mush</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/mac.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>NoteBook</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                Links
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="openstack-Mitaka">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-04-17 14:47" pubdate>
        April 17, 2022 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      45k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      376 分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">openstack-Mitaka</h1>
            
            <div class="markdown-body">
              <h1 id="OpenStack-M版搭建"><a href="#OpenStack-M版搭建" class="headerlink" title="OpenStack M版搭建"></a>OpenStack M版搭建</h1><p><img src="https://i.bmp.ovh/imgs/2022/04/17/3f71c9177e94cb22.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="密码表：-密码均为密码名称"><a href="#密码表：-密码均为密码名称" class="headerlink" title="密码表：(密码均为密码名称)"></a>密码表：(密码均为密码名称)</h2><table>
<thead>
<tr>
<th align="center">密码名称</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">数据库密码(不能使用变量)</td>
<td align="center">数据库的root密码</td>
</tr>
<tr>
<td align="center"><code>ADMIN_PASS</code></td>
<td align="center"><code>admin</code> 用户密码</td>
</tr>
<tr>
<td align="center"><code>CEILOMETER_DBPASS</code></td>
<td align="center">Telemetry 服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>CEILOMETER_PASS</code></td>
<td align="center">Telemetry 服务的 <code>ceilometer</code> 用户密码</td>
</tr>
<tr>
<td align="center"><code>CINDER_DBPASS</code></td>
<td align="center">块设备存储服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>CINDER_PASS</code></td>
<td align="center">块设备存储服务的 <code>cinder</code> 密码</td>
</tr>
<tr>
<td align="center"><code>DASH_DBPASS</code></td>
<td align="center">Database password for the dashboard</td>
</tr>
<tr>
<td align="center"><code>DEMO_PASS</code></td>
<td align="center"><code>demo</code> 用户的密码</td>
</tr>
<tr>
<td align="center"><code>GLANCE_DBPASS</code></td>
<td align="center">镜像服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>GLANCE_PASS</code></td>
<td align="center">镜像服务的 <code>glance</code> 用户密码</td>
</tr>
<tr>
<td align="center"><code>HEAT_DBPASS</code></td>
<td align="center">Orchestration服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>HEAT_DOMAIN_PASS</code></td>
<td align="center">Orchestration 域的密码</td>
</tr>
<tr>
<td align="center"><code>HEAT_PASS</code></td>
<td align="center">Orchestration 服务中<code>heat</code>用户的密码</td>
</tr>
<tr>
<td align="center"><code>KEYSTONE_DBPASS</code></td>
<td align="center">认证服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>NEUTRON_DBPASS</code></td>
<td align="center">网络服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>NEUTRON_PASS</code></td>
<td align="center">网络服务的 <code>neutron</code> 用户密码</td>
</tr>
<tr>
<td align="center"><code>NOVA_DBPASS</code></td>
<td align="center">计算服务的数据库密码</td>
</tr>
<tr>
<td align="center"><code>NOVA_PASS</code></td>
<td align="center">计算服务中<code>nova</code>用户的密码</td>
</tr>
<tr>
<td align="center"><code>RABBIT_PASS</code></td>
<td align="center">RabbitMQ的guest用户密码</td>
</tr>
<tr>
<td align="center"><code>SWIFT_PASS</code></td>
<td align="center">对象存储服务用户<code>swift</code>的密码</td>
</tr>
</tbody></table>
<h2 id="主机配置"><a href="#主机配置" class="headerlink" title="主机配置"></a>主机配置</h2><table>
<thead>
<tr>
<th align="center">主机名</th>
<th align="center">IP</th>
<th align="center">内存</th>
<th align="center">硬盘</th>
<th align="center">网卡数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">controller</td>
<td align="center">172.16.100.28</td>
<td align="center">8G</td>
<td align="center">80G</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">compute</td>
<td align="center">172.16.100.29</td>
<td align="center">8G</td>
<td align="center">80G</td>
<td align="center">1</td>
</tr>
</tbody></table>
<h3 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h3><h4 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">hostnamectl set-hostname controller<br></code></pre></div></td></tr></table></figure>

<h4 id="compute"><a href="#compute" class="headerlink" title="compute"></a>compute</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">hostnamectl set-hostname compute<br></code></pre></div></td></tr></table></figure>

<!--注意重新连接 否则后面创建Rabbitmq用户可能会报错-->

<h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><h3 id="controller配置"><a href="#controller配置" class="headerlink" title="controller配置"></a>controller配置</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">vi /etc/sysconfig/network-scripts/ifcfg-eth0<br><br>ONBOOT=yes<br>BOOTPROTO=static<br>IPADDR=172.16.100.28<br>NETMASK=255.255.255.0<br>GATEWAY=172.16.100.254<br>DNS1=114.114.114.114<br></code></pre></div></td></tr></table></figure>

<h3 id="compute配置"><a href="#compute配置" class="headerlink" title="compute配置"></a>compute配置</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">vi /etc/sysconfig/network-scripts/ifcfg-eth0<br><br>ONBOOT=yes<br>BOOTPROTO=static<br>IPADDR=172.16.100.29<br>NETMASK=255.255.255.0<br>GATEWAY=172.16.100.254<br>DNS1=114.114.114.114<br></code></pre></div></td></tr></table></figure>

<p>：wq 保存退出</p>
<h3 id="重启网卡"><a href="#重启网卡" class="headerlink" title="重启网卡"></a>重启网卡</h3><!--在controller和compute均执行-->

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl restart network<br></code></pre></div></td></tr></table></figure>

<h4 id="controller-1"><a href="#controller-1" class="headerlink" title="controller"></a>controller</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# ip addr<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000<br>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>       valid_lft forever preferred_lft forever<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br>    link/ether 52:54:00:00:db:9c brd ff:ff:ff:ff:ff:ff<br>    inet 172.16.100.28/24 brd 172.16.100.255 scope global noprefixroute eth0<br>       valid_lft forever preferred_lft forever<br>    inet6 fe80::6010:d73a:2158:5fe8/64 scope link noprefixroute <br>       valid_lft forever preferred_lft forever<br></code></pre></div></td></tr></table></figure>

<h4 id="compute-1"><a href="#compute-1" class="headerlink" title="compute"></a>compute</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]# ip addr<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000<br>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>       valid_lft forever preferred_lft forever<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br>    link/ether 52:54:00:3c:b9:4c brd ff:ff:ff:ff:ff:ff<br>    inet 172.16.100.29/24 brd 172.16.100.255 scope global noprefixroute eth0<br>       valid_lft forever preferred_lft forever<br>    inet6 fe80::c374:72b:eb12:5916/64 scope link noprefixroute <br>       valid_lft forever preferred_lft forever<br></code></pre></div></td></tr></table></figure>

<h2 id="初始化配置"><a href="#初始化配置" class="headerlink" title="初始化配置"></a>初始化配置</h2><h3 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><!--在controller和compute均执行-->

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl stop firewalld<br>systemctl disable firewalld<br></code></pre></div></td></tr></table></figure>

<h3 id="关闭网卡守护进程"><a href="#关闭网卡守护进程" class="headerlink" title="关闭网卡守护进程"></a>关闭网卡守护进程</h3><!--在controller和compute均执行-->

<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shel">systemctl stop NetworkManager<br>systemctl disable NetworkManager<br></code></pre></div></td></tr></table></figure>

<h3 id="关闭SElinux"><a href="#关闭SElinux" class="headerlink" title="关闭SElinux"></a>关闭SElinux</h3><!--在controller和compute均执行-->

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">setenforce 0<br><br>vi /etc/selinux/config<br><br>修改 SELINUX=enforcing 为 SELINUX=disabled<br><br>:wq 保存退出<br></code></pre></div></td></tr></table></figure>

<h3 id="查看SElinux状态"><a href="#查看SElinux状态" class="headerlink" title="查看SElinux状态"></a>查看SElinux状态</h3><!--在controller和compute均执行-->

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# getenforce <br>Permissive<br><br>[root@compute ~]# getenforce <br>Permissive<br><br></code></pre></div></td></tr></table></figure>

<h3 id="配置yum源"><a href="#配置yum源" class="headerlink" title="配置yum源"></a>配置yum源</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">将目录下的源删除<br>rm -rf /etc/yum.repos.d/C*<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">controller</span><br>[root@controller ~]# cat /etc/yum.repos.d/http.repo <br>[centos]<br>name=centos<br>baseurl=ftp://172.16.100.66/centos<br>gpgcheck=0<br>[openstack-m]<br>name=openstack-m<br>baseurl=ftp://172.16.100.66/openstack-m<br>gpgcheck=0<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">compute</span><br>[root@compute ~]# cat /etc/yum.repos.d/http.repo <br>[centos]<br>name=centos<br>baseurl=ftp://172.16.100.66/centos<br>gpgcheck=0<br>[openstack-m]<br>name=openstack-m<br>baseurl=ftp://172.16.100.66/openstack-m<br>gpgcheck=0<br></code></pre></div></td></tr></table></figure>

<blockquote>
<p>此处用的是配置本地源，一个Centos，一个OpenStack源</p>
<p>附上国内阿里源<a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/centos/7/cloud/x86_64/openstack-queens/">https://mirrors.aliyun.com/centos/7/cloud/x86_64/openstack-queens/</a></p>
</blockquote>
<h3 id="配置host解析"><a href="#配置host解析" class="headerlink" title="配置host解析"></a>配置host解析</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# cat /etc/hosts<br>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4<br>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6<br><br>172.16.100.28 controller<br>172.16.100.29 compute<br></code></pre></div></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]# cat /etc/hosts<br>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4<br>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6<br><br>172.16.100.28 controller<br>172.16.100.29 compute<br></code></pre></div></td></tr></table></figure>

<h3 id="测试各节点之间与Internet的通信"><a href="#测试各节点之间与Internet的通信" class="headerlink" title="测试各节点之间与Internet的通信"></a>测试各节点之间与Internet的通信</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# ping -c 2 compute<br>PING compute (172.16.100.29) 56(84) bytes of data.<br>64 bytes from compute (172.16.100.29): icmp_seq=1 ttl=64 time=0.250 ms<br>64 bytes from compute (172.16.100.29): icmp_seq=2 ttl=64 time=0.447 ms<br><br>--- compute ping statistics ---<br>2 packets transmitted, 2 received, 0% packet loss, time 1000ms<br>rtt min/avg/max/mdev = 0.250/0.348/0.447/0.100 m<br></code></pre></div></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]# ping -c 2 controller<br>PING controller (172.16.100.28) 56(84) bytes of data.<br>64 bytes from controller (172.16.100.28): icmp_seq=1 ttl=64 time=0.378 ms<br>64 bytes from controller (172.16.100.28): icmp_seq=2 ttl=64 time=0.391 ms<br><br>--- controller ping statistics ---<br>2 packets transmitted, 2 received, 0% packet loss, time 1000ms<br>rtt min/avg/max/mdev = 0.378/0.384/0.391/0.020 ms<br></code></pre></div></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# ping -c 2 baidu.com<br>PING baidu.com (220.181.38.251) 56(84) bytes of data.<br>64 bytes from 220.181.38.251 (220.181.38.251): icmp_seq=1 ttl=47 time=174 ms<br>64 bytes from 220.181.38.251 (220.181.38.251): icmp_seq=2 ttl=47 time=173 ms<br><br>--- baidu.com ping statistics ---<br>2 packets transmitted, 2 received, 0% packet loss, time 1001ms<br>rtt min/avg/max/mdev = 173.205/173.637/174.070/0.600 ms<br></code></pre></div></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]# ping -c 2 baidu.com<br>PING baidu.com (220.181.38.251) 56(84) bytes of data.<br>64 bytes from 220.181.38.251 (220.181.38.251): icmp_seq=1 ttl=47 time=174 ms<br>64 bytes from 220.181.38.251 (220.181.38.251): icmp_seq=2 ttl=47 time=171 ms<br><br>--- baidu.com ping statistics ---<br>2 packets transmitted, 2 received, 0% packet loss, time 1000ms<br>rtt min/avg/max/mdev = 171.844/173.164/174.484/1.320 ms<br></code></pre></div></td></tr></table></figure>

<h3 id="修改时间同步配置文件"><a href="#修改时间同步配置文件" class="headerlink" title="修改时间同步配置文件"></a>修改时间同步配置文件</h3><h4 id="controller-2"><a href="#controller-2" class="headerlink" title="controller"></a>controller</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">vi /etc/chrony.conf<br><br>server ntp.aliyun.com iburst<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">##大概26行左右###</span></span><br>allow 172.16.100.0/24<br></code></pre></div></td></tr></table></figure>

<h4 id="compute-2"><a href="#compute-2" class="headerlink" title="compute"></a>compute</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">vi /etc/chrony.conf<br><br>server controller iburst<br></code></pre></div></td></tr></table></figure>

<h4 id="重启chrony服务"><a href="#重启chrony服务" class="headerlink" title="重启chrony服务"></a>重启chrony服务</h4><!--在controller和compute均执行-->

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl restart chronyd<br></code></pre></div></td></tr></table></figure>

<h4 id="验证是否同步成功"><a href="#验证是否同步成功" class="headerlink" title="验证是否同步成功"></a>验证是否同步成功</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# chronyc sources<br>210 Number of sources = 1<br>MS Name/IP address         Stratum Poll Reach LastRx Last sample               <br>===============================================================================<br>^* 203.107.6.88                  2   6   367    79   +140us[ +789us] +/-   95ms<br></code></pre></div></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]# chronyc sources<br>210 Number of sources = 1<br>MS Name/IP address         Stratum Poll Reach LastRx Last sample               <br>===============================================================================<br>^* controller                    3   6   377     9    -34us[ +664us] +/-   96ms<br><br></code></pre></div></td></tr></table></figure>

<h3 id="所有节点安装openstack客户端和openstack-selinux"><a href="#所有节点安装openstack客户端和openstack-selinux" class="headerlink" title="所有节点安装openstack客户端和openstack-selinux"></a>所有节点安装openstack客户端和openstack-selinux</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install python-openstackclient openstack-selinux<br></code></pre></div></td></tr></table></figure>

<h3 id="安装Mariadb数据库-controller"><a href="#安装Mariadb数据库-controller" class="headerlink" title="安装Mariadb数据库(controller)"></a>安装Mariadb数据库(controller)</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install mariadb mariadb-server python2-PyMySQL<br></code></pre></div></td></tr></table></figure>

<p>创建和编辑<code>/etc/my.cnf.d/openstack.cnf</code>文件并添加以下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shel">[mysqld]<br>bind-address = 172.16.100.28 #controller IP地址<br>default-storage-engine = innodb<br>innodb_file_per_table<br>max_connections = 4096<br>collation-server = utf8_general_ci<br>character-set-server = utf8<br></code></pre></div></td></tr></table></figure>

<h4 id="启动mariadb"><a href="#启动mariadb" class="headerlink" title="启动mariadb"></a>启动mariadb</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl start mariadb<br>systemctl enable mariadb<br></code></pre></div></td></tr></table></figure>

<h4 id="数据库默认初始化-设置密码000000"><a href="#数据库默认初始化-设置密码000000" class="headerlink" title="数据库默认初始化 (设置密码000000)"></a>数据库默认初始化 (设置密码000000)</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# mysql_secure_installation<br><br>NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB<br>      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!<br><br>In order to log into MariaDB to secure it, we&#x27;ll need the current<br>password for the root user.  If you&#x27;ve just installed MariaDB, and<br>you haven&#x27;t set the root password yet, the password will be blank,<br>so you should just press enter here.<br><br>Enter current password for root (enter for none): <br>OK, successfully used password, moving on...<br><br>Setting the root password ensures that nobody can log into the MariaDB<br>root user without the proper authorisation.<br><br>Set root password? [Y/n] y<br>New password: <br>Re-enter new password: <br>Password updated successfully!<br>Reloading privilege tables..<br> ... Success!<br><br><br>By default, a MariaDB installation has an anonymous user, allowing anyone<br>to log into MariaDB without having to have a user account created for<br>them.  This is intended only for testing, and to make the installation<br>go a bit smoother.  You should remove them before moving into a<br>production environment.<br><br>Remove anonymous users? [Y/n] y<br> ... Success!<br><br>Normally, root should only be allowed to connect from &#x27;localhost&#x27;.  This<br>ensures that someone cannot guess at the root password from the network.<br><br>Disallow root login remotely? [Y/n] y<br> ... Success!<br><br>By default, MariaDB comes with a database named &#x27;test&#x27; that anyone can<br>access.  This is also intended only for testing, and should be removed<br>before moving into a production environment.<br><br>Remove test database and access to it? [Y/n] y<br> - Dropping test database...<br> ... Success!<br> - Removing privileges on test database...<br> ... Success!<br><br>Reloading the privilege tables will ensure that all changes made so far<br>will take effect immediately.<br><br>Reload privilege tables now? [Y/n] y<br> ... Success!<br><br>Cleaning up...<br><br>All done!  If you&#x27;ve completed all of the above steps, your MariaDB<br>installation should now be secure.<br><br>Thanks for using MariaDB!<br></code></pre></div></td></tr></table></figure>

<h3 id="安装rabbitmq并创建用户-controller"><a href="#安装rabbitmq并创建用户-controller" class="headerlink" title="安装rabbitmq并创建用户(controller)"></a>安装rabbitmq并创建用户(controller)</h3><p>1、功能:协调操作和状态信息服务</p>
<p>2、常用的消息代理软件</p>
<p>​			RabbitMQ</p>
<p>​			Qpid</p>
<p>​			ZeroMQ</p>
<p>3.在controller节点安装RabbitMQ</p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.安装RabbitMQ软件包<br>	yum -y install rabbitmq-server<br>b.启动服务并设置开机自启动<br>	systemctl enable rabbitmq-server<br>	systemctl start rabbitmq-server<br>查看运行状态<br>	systemctl status rabbitmq-server<br>c.创建用户<br>	rabbitmqctl add_user openstack RABBIT_PASS<br>	rabbitmqctl set_permissions openstack &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;<br></code></pre></div></td></tr></table></figure>

<h3 id="安装memcached缓存-controller"><a href="#安装memcached缓存-controller" class="headerlink" title="安装memcached缓存(controller)"></a>安装memcached缓存(controller)</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.安装memcached软件包<br>	yum -y install memcached python-memcached<br>b.修改配置文件的地址否则其他网络无法访问<br>	sed -i &#x27;s#127.0.0.1#172.16.100.28#g&#x27; /etc/sysconfig/memcached  ##注意IP更换成自己的<br>c.启动服务并设置开机自启动<br>	systemctl start memcached.service<br>	systemctl enable memcached.service<br></code></pre></div></td></tr></table></figure>

<h2 id="Keystone认证服务"><a href="#Keystone认证服务" class="headerlink" title="Keystone认证服务"></a>Keystone认证服务</h2><p>keystone认证方式:UUID,PKI,Fernet   随机生成字符串的方法</p>
<p>功能:认证管理,授权管理,服务目录</p>
<h3 id="在控制节点创建认证服务数据库-controller"><a href="#在控制节点创建认证服务数据库-controller" class="headerlink" title="在控制节点创建认证服务数据库(controller)"></a>在控制节点创建认证服务数据库(controller)</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.登录mysql数据库<br>	mysql -u root -p000000<br>b.创建keystone数据库<br>	CREATE DATABASE keystone;<br>c.创建keystone数据库用户，使其可以对keystone数据库有完全控制权限<br>	GRANT ALL PRIVILEGES ON keystone.* TO &#x27;keystone&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;KEYSTONE_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON keystone.* TO &#x27;keystone&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;KEYSTONE_DBPASS&#x27;;<br>d.退出数据库<br>	exit<br></code></pre></div></td></tr></table></figure>

<h3 id="安装keystone相关软件包-和openstack-utils-noarch软件包"><a href="#安装keystone相关软件包-和openstack-utils-noarch软件包" class="headerlink" title="安装keystone相关软件包 和openstack-utils.noarch软件包"></a>安装keystone相关软件包 和openstack-utils.noarch软件包</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-keystone httpd mod_wsgi openstack-utils.noarch<br></code></pre></div></td></tr></table></figure>

<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/keystone/keystone.conf /etc/keystone/keystone.conf.bak<br>grep -Ev &#x27;^$|#&#x27; /etc/keystone/keystone.conf.bak &gt; /etc/keystone/keystone.conf<br><br>openstack-config --set /etc/keystone/keystone.conf DEFAULT admin_token ADMIN_TOKEN<br>openstack-config --set /etc/keystone/keystone.conf  database connection mysql+pymysql://keystone:KEYSTONE_DBPASS@controller/keystone<br>openstack-config --set /etc/keystone/keystone.conf  token provider fernet<br></code></pre></div></td></tr></table></figure>

<h3 id="同步keystone数据库"><a href="#同步keystone数据库" class="headerlink" title="同步keystone数据库"></a>同步keystone数据库</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">su -s /bin/sh -c &quot;keystone-manage db_sync&quot; keystone<br></code></pre></div></td></tr></table></figure>

<!--同步后进入数据库查看keystone库是否有数据-->

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">如果同步失败,将/var/log/keystone/keystone.log修改属组,重启httpd<br><br>chown -R keystone.keystone /var/log/keystone/keystone.log<br>systemctl restart httpd<br></code></pre></div></td></tr></table></figure>

<h3 id="初始化fernet"><a href="#初始化fernet" class="headerlink" title="初始化fernet"></a>初始化fernet</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">keystone-manage fernet_setup --keystone-user keystone --keystone-group keystone<br></code></pre></div></td></tr></table></figure>

<h3 id="配置Apache-HTTP服务器"><a href="#配置Apache-HTTP服务器" class="headerlink" title="配置Apache HTTP服务器"></a>配置Apache HTTP服务器</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">ln -s /usr/share/keystone/wsgi-keystone.conf /etc/httpd/conf.d/<br>echo &quot;ServerName controller&quot; &gt;&gt;/etc/httpd/conf/httpd.conf<br></code></pre></div></td></tr></table></figure>

<p>配置以下文件</p>
<p>###将原有是删除</p>
<p>vim &#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;wsgi-keystone.conf </p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">Listen 5000<br>Listen 35357<br><br>&lt;VirtualHost *:5000&gt;<br>    WSGIDaemonProcess keystone-public processes=5 threads=1 user=keystone group=keystone display-name=%&#123;GROUP&#125;<br>    WSGIProcessGroup keystone-public<br>    WSGIScriptAlias / /usr/bin/keystone-wsgi-public<br>    WSGIApplicationGroup %&#123;GLOBAL&#125;<br>    WSGIPassAuthorization On<br>    ErrorLogFormat &quot;%&#123;cu&#125;t %M&quot;<br>    ErrorLog /var/log/httpd/keystone-error.log<br>    CustomLog /var/log/httpd/keystone-access.log combined<br><br>    &lt;Directory /usr/bin&gt;<br>        Require all granted<br>    &lt;/Directory&gt;<br>&lt;/VirtualHost&gt;<br><br>&lt;VirtualHost *:35357&gt;<br>    WSGIDaemonProcess keystone-admin processes=5 threads=1 user=keystone group=keystone display-name=%&#123;GROUP&#125;<br>    WSGIProcessGroup keystone-admin<br>    WSGIScriptAlias / /usr/bin/keystone-wsgi-admin<br>    WSGIApplicationGroup %&#123;GLOBAL&#125;<br>    WSGIPassAuthorization On<br>    ErrorLogFormat &quot;%&#123;cu&#125;t %M&quot;<br>    ErrorLog /var/log/httpd/keystone-error.log<br>    CustomLog /var/log/httpd/keystone-access.log combined<br><br>    &lt;Directory /usr/bin&gt;<br>        Require all granted<br>    &lt;/Directory&gt;<br>&lt;/VirtualHost&gt;<br></code></pre></div></td></tr></table></figure>

<h4 id="启动HTTP服务"><a href="#启动HTTP服务" class="headerlink" title="启动HTTP服务"></a>启动HTTP服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl enable httpd.service<br>systemctl start httpd.service<br></code></pre></div></td></tr></table></figure>

<h3 id="创建服务和注册api"><a href="#创建服务和注册api" class="headerlink" title="创建服务和注册api:"></a>创建服务和注册api:</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">export OS_TOKEN=ADMIN_TOKEN<br>export OS_URL=http://controller:35357/v3<br>export OS_IDENTITY_API_VERSION=3<br><br>openstack service create \<br>  --name keystone --description &quot;OpenStack Identity&quot; identity<br><br>openstack endpoint create --region RegionOne \<br>  identity public http://controller:5000/v3<br>  <br>openstack endpoint create --region RegionOne \<br>  identity internal http://controller:5000/v3　　<br><span class="hljs-meta prompt_"> #</span><span class="language-bash">前两个为5000端口，专门处理内部和外部的访问</span><br>  　　　　　　　　　　　　　　　　　　　　　　　　　　　　<br>openstack endpoint create --region RegionOne \<br>  identity admin http://controller:35357/v3<br><span class="hljs-meta prompt_"> #</span><span class="language-bash">35357端口，专门处理admin</span><br></code></pre></div></td></tr></table></figure>

<h3 id="创建域-项目-用户-角色"><a href="#创建域-项目-用户-角色" class="headerlink" title="创建域,项目,用户,角色"></a>创建域,项目,用户,角色</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack domain create --description &quot;Default Domain&quot; default<br><br>openstack project create --domain default \<br>   --description &quot;Admin Project&quot; admin <br><br>openstack user create --domain default \<br>   --password ADMIN_PASS admin　　　　<br><br>openstack role create admin  <br><br>openstack role add --project admin --user admin admin<br><br>openstack project create --domain default \<br>--description &quot;Service Project&quot; service<br></code></pre></div></td></tr></table></figure>

<h3 id="创建环境变量脚本"><a href="#创建环境变量脚本" class="headerlink" title="创建环境变量脚本"></a>创建环境变量脚本</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# cat admin-openrc <br>export OS_PROJECT_DOMAIN_NAME=default<br>export OS_USER_DOMAIN_NAME=default<br>export OS_PROJECT_NAME=admin<br>export OS_USERNAME=admin<br>export OS_PASSWORD=ADMIN_PASS<br>export OS_AUTH_URL=http://controller:35357/v3<br>export OS_IDENTITY_API_VERSION=3<br>export OS_IMAGE_API_VERSION=2<br></code></pre></div></td></tr></table></figure>

<h3 id="取消前面设置的环境变量"><a href="#取消前面设置的环境变量" class="headerlink" title="取消前面设置的环境变量"></a>取消前面设置的环境变量</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">unset OS_TOKEN<br></code></pre></div></td></tr></table></figure>

<h3 id="使环境变量生效"><a href="#使环境变量生效" class="headerlink" title="使环境变量生效"></a>使环境变量生效</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">source admin-openrc<br></code></pre></div></td></tr></table></figure>

<h3 id="验证环境变量是否成功"><a href="#验证环境变量是否成功" class="headerlink" title="验证环境变量是否成功"></a>验证环境变量是否成功</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack token issue<br></code></pre></div></td></tr></table></figure>

<p>### 注意环境变量问题:先取消前面设置的环境变量,否则会报错###</p>
<h2 id="Glance镜像服务"><a href="#Glance镜像服务" class="headerlink" title="Glance镜像服务"></a>Glance镜像服务</h2><p><strong>glance-api</strong></p>
<p>接收镜像API的调用，诸如镜像发现、恢复、存储。</p>
<p><strong>glance-registry</strong></p>
<p>存储、处理和恢复镜像的元数据，元数据包括项诸如大小和类型。</p>
<h3 id="在控制节点创建镜像服务数据库-controller"><a href="#在控制节点创建镜像服务数据库-controller" class="headerlink" title="在控制节点创建镜像服务数据库(controller)"></a>在控制节点创建镜像服务数据库(controller)</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.登录mysql数据库<br>	mysql -u root -p000000<br>b.创建glance数据库<br>	CREATE DATABASE glance;<br>c.创建glance数据库用户，使其可以对glance数据库有完全控制权限<br>	GRANT ALL PRIVILEGES ON glance.* TO &#x27;glance&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;GLANCE_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON glance.* TO &#x27;glance&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;GLANCE_DBPASS&#x27;;<br>d.退出数据库<br>	exit<br></code></pre></div></td></tr></table></figure>

<h3 id="在keystone创建glance用户关联角色"><a href="#在keystone创建glance用户关联角色" class="headerlink" title="在keystone创建glance用户关联角色"></a>在keystone创建glance用户关联角色</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack user create --domain default --password GLANCE_PASS glance<br>openstack role add --project service --user glance admin<br><br>验证是否成功<br>openstack role assignment list<br></code></pre></div></td></tr></table></figure>

<h3 id="在keystone创建服务和注册api"><a href="#在keystone创建服务和注册api" class="headerlink" title="在keystone创建服务和注册api"></a>在keystone创建服务和注册api</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack service create --name glance \<br>--description &quot;OpenStack Image&quot; image<br>openstack endpoint create --region RegionOne \<br>  image public http://controller:9292<br>openstack endpoint create --region RegionOne \<br>  image internal http://controller:9292<br>openstack endpoint create --region RegionOne \<br>  image admin http://controller:9292<br></code></pre></div></td></tr></table></figure>

<h3 id="安装glance软件包"><a href="#安装glance软件包" class="headerlink" title="安装glance软件包"></a>安装glance软件包</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-glance<br></code></pre></div></td></tr></table></figure>

<h3 id="修改配置文件-1"><a href="#修改配置文件-1" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p><strong>&#x2F;etc&#x2F;glance&#x2F;glance-api.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/glance/glance-api.conf&#123;,.bak&#125;<br>grep &#x27;^[a-z\[]&#x27; /etc/glance/glance-api.conf.bak &gt;/etc/glance/glance-api.conf<br><br>openstack-config --set /etc/glance/glance-api.conf database connection mysql+pymysql://glance:GLANCE_DBPASS@controller/glance<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_type password<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken project_domain_name default<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken user_domain_name default<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken project_name service<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken username glance<br>openstack-config --set /etc/glance/glance-api.conf keystone_authtoken password GLANCE_PASS<br>openstack-config --set /etc/glance/glance-api.conf  paste_deploy flavor keystone<br>openstack-config --set /etc/glance/glance-api.conf glance_store stores file,http<br>openstack-config --set /etc/glance/glance-api.conf glance_store default_store file<br>openstack-config --set /etc/glance/glance-api.conf glance_store filesystem_store_datadir /var/lib/glance/images/<br></code></pre></div></td></tr></table></figure>

<p><strong>&#x2F;etc&#x2F;glance&#x2F;glance-registry.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp  /etc/glance/glance-registry.conf&#123;,.bak&#125;<br>grep &#x27;^[a-z\[]&#x27; /etc/glance/glance-registry.conf.bak &gt;/etc/glance/glance-registry.conf<br><br>openstack-config --set /etc/glance/glance-registry.conf database connection mysql+pymysql://glance:GLANCE_DBPASS@controller/glance<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_type password<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken project_domain_name default<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken user_domain_name default<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken project_name service<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken username glance<br>openstack-config --set /etc/glance/glance-registry.conf keystone_authtoken password GLANCE_PASS<br>openstack-config --set /etc/glance/glance-registry.conf paste_deploy flavor keystone<br></code></pre></div></td></tr></table></figure>

<h3 id="同步glance数据库"><a href="#同步glance数据库" class="headerlink" title="同步glance数据库"></a>同步glance数据库</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">su -s /bin/sh -c &quot;glance-manage db_sync&quot; glance<br></code></pre></div></td></tr></table></figure>

<!--同步后进入数据库查看glance库是否有数据-->

<!--忽略警告-->

<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl enable openstack-glance-api.service openstack-glance-registry.service<br>systemctl start openstack-glance-api.service openstack-glance-registry.service<br></code></pre></div></td></tr></table></figure>

<h3 id="下载测试镜像cirros"><a href="#下载测试镜像cirros" class="headerlink" title="下载测试镜像cirros"></a>下载测试镜像cirros</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">wget http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img<br></code></pre></div></td></tr></table></figure>

<p>###下载不了多试几次###</p>
<h3 id="上传镜像测试"><a href="#上传镜像测试" class="headerlink" title="上传镜像测试"></a>上传镜像测试</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack image create &quot;cirros&quot;  --file cirros-0.3.4-x86_64-disk.img  --disk-format qcow2 --container-format bare  --public<br></code></pre></div></td></tr></table></figure>

<h2 id="Nova计算服务"><a href="#Nova计算服务" class="headerlink" title="Nova计算服务"></a>Nova计算服务</h2><p>nova-api:				接受响应所有的计算服务请求，管理虚拟机(云主机)生命周期</p>
<p>nova-compute (多个):	真正管理虚拟机(nova-compute调用libvirt)</p>
<p>nova-scheduler:		nova调度器（挑选出最合适的nova-compute来创建虚机)</p>
<p>nova-conductor:		帮助nova-compute代理修改数据库中虚拟机的状态</p>
<p>nova-network			早期openstack版本管理虚拟机的网络(已弃用,neutron)</p>
<p>nova-consoleauth和nova-novncproxy: web版的vnc来直接操作云主机</p>
<p>novncproxy:			web版vnc客户端</p>
<p>nova-api-metadata:		接受来自虚拟机发送的元数据请求(配合neutron-metadata-agent,来虚拟机定制化)</p>
<h3 id="controller-3"><a href="#controller-3" class="headerlink" title="controller"></a>controller</h3><h4 id="在控制节点创建nova服务数据库-controller"><a href="#在控制节点创建nova服务数据库-controller" class="headerlink" title="在控制节点创建nova服务数据库(controller)"></a>在控制节点创建nova服务数据库(controller)</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.登录mysql数据库<br>	mysql -u root -p000000<br>b.创建nova_api,nova数据库<br>	CREATE DATABASE nova_api;<br>	CREATE DATABASE nova;<br>c.创建nova_api，nova数据库用户，使其可以对nova_api,nova数据库有完全控制权限<br>	GRANT ALL PRIVILEGES ON nova_api.* TO &#x27;nova&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;NOVA_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON nova_api.* TO &#x27;nova&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;NOVA_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON nova.* TO &#x27;nova&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;NOVA_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON nova.* TO &#x27;nova&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;NOVA_DBPASS&#x27;;<br>d.退出数据库<br>	exit<br></code></pre></div></td></tr></table></figure>

<h4 id="在keystone创建系统用户（glance，nova，neutron）关联角色"><a href="#在keystone创建系统用户（glance，nova，neutron）关联角色" class="headerlink" title="在keystone创建系统用户（glance，nova，neutron）关联角色"></a>在keystone创建系统用户（glance，nova，neutron）关联角色</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack user create --domain default --password NOVA_PASS nova<br>openstack role add --project service --user nova admin<br></code></pre></div></td></tr></table></figure>

<h4 id="在keystone上创建服务和注册api"><a href="#在keystone上创建服务和注册api" class="headerlink" title="在keystone上创建服务和注册api"></a>在keystone上创建服务和注册api</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack service create --name nova \<br>  --description &quot;OpenStack Compute&quot; compute<br>openstack endpoint create --region RegionOne \<br>  compute public http://controller:8774/v2.1/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  compute internal http://controller:8774/v2.1/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  compute admin http://controller:8774/v2.1/%\(tenant_id\)s<br></code></pre></div></td></tr></table></figure>

<h4 id="安装相关服务软件包"><a href="#安装相关服务软件包" class="headerlink" title="安装相关服务软件包"></a>安装相关服务软件包</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-nova-api openstack-nova-conductor \<br>  openstack-nova-console openstack-nova-novncproxy \<br>  openstack-nova-scheduler<br></code></pre></div></td></tr></table></figure>

<h4 id="修改配置文件-2"><a href="#修改配置文件-2" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p><strong>&#x2F;etc&#x2F;nova&#x2F;nova.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/nova/nova.conf&#123;,.bak&#125;<br>grep &#x27;^[a-Z\[]&#x27; /etc/nova/nova.conf.bak &gt;/etc/nova/nova.conf<br><br>openstack-config --set /etc/nova/nova.conf DEFAULT enabled_apis osapi_compute , metadata<br>openstack-config --set /etc/nova/nova.conf api_database connection mysql+pymysql://nova:NOVA_DBPASS@controller/nova_api<br>openstack-config --set /etc/nova/nova.conf database connection mysql+pymysql://nova:NOVA_DBPASS@controller/nova<br>openstack-config --set /etc/nova/nova.conf DEFAULT rpc_backend rabbit<br>openstack-config --set /etc/nova/nova.conf oslo_messaging_rabbit rabbit_host controller<br>openstack-config --set /etc/nova/nova.conf oslo_messaging_rabbit rabbit_userid openstack<br>openstack-config --set /etc/nova/nova.conf oslo_messaging_rabbit rabbit_password RABBIT_PASS<br>openstack-config --set /etc/nova/nova.conf DEFAULT auth_strategy keystone<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_type password<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken project_domain_name default<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken user_domain_name default<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken project_name service<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken username nova<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken password NOVA_PASS<br>openstack-config --set /etc/nova/nova.conf DEFAULT my_ip 172.16.100.28		###替换自己的IP!!!<br>openstack-config --set /etc/nova/nova.conf DEFAULT use_neutron True<br>openstack-config --set /etc/nova/nova.conf DEFAULT firewall_driver nova.virt.firewall.NoopFirewallDriver<br>openstack-config --set /etc/nova/nova.conf vnc vncserver_listen &#x27;$my_ip&#x27;<br>openstack-config --set /etc/nova/nova.conf vnc vncserver_proxyclient_address &#x27;$my_ip&#x27;<br>openstack-config --set /etc/nova/nova.conf glance api_servers http://controller:9292<br>openstack-config --set /etc/nova/nova.conf oslo_concurrency lock_path /var/lib/nova/tmp<br></code></pre></div></td></tr></table></figure>

<h4 id="同步数据库"><a href="#同步数据库" class="headerlink" title="同步数据库"></a>同步数据库</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">su -s /bin/sh -c &quot;nova-manage api_db sync&quot; nova<br>su -s /bin/sh -c &quot;nova-manage db sync&quot; nova<br></code></pre></div></td></tr></table></figure>

<!--同步后进入数据库查看nova库是否有数据-->

<!--忽略警告-->

<h4 id="启动服务-1"><a href="#启动服务-1" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl enable openstack-nova-api.service \<br>  openstack-nova-consoleauth.service openstack-nova-scheduler.service \<br>  openstack-nova-conductor.service openstack-nova-novncproxy.service<br>systemctl start openstack-nova-api.service \<br>  openstack-nova-consoleauth.service openstack-nova-scheduler.service \<br>  openstack-nova-conductor.service openstack-nova-novncproxy.service<br></code></pre></div></td></tr></table></figure>

<h3 id="compute-3"><a href="#compute-3" class="headerlink" title="compute"></a>compute</h3><h4 id="安装软件包"><a href="#安装软件包" class="headerlink" title="安装软件包"></a>安装软件包</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-nova-compute openstack-utils.noarch<br></code></pre></div></td></tr></table></figure>

<h4 id="修改配置文件-3"><a href="#修改配置文件-3" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p><strong>&#x2F;etc&#x2F;nova&#x2F;nova.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/nova/nova.conf&#123;,.bak&#125;<br>grep &#x27;^[a-Z\[]&#x27; /etc/nova/nova.conf.bak &gt;/etc/nova/nova.conf<br><br>openstack-config --set /etc/nova/nova.conf DEFAULT rpc_backend rabbit<br>openstack-config --set /etc/nova/nova.conf oslo_messaging_rabbit rabbit_host controller<br>openstack-config --set /etc/nova/nova.conf oslo_messaging_rabbit rabbit_userid openstack<br>openstack-config --set /etc/nova/nova.conf oslo_messaging_rabbit rabbit_password RABBIT_PASS<br>openstack-config --set /etc/nova/nova.conf DEFAULT auth_strategy keystone<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken auth_type password<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken project_domain_name default<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken user_domain_name default<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken project_name service<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken username nova<br>openstack-config --set /etc/nova/nova.conf keystone_authtoken password NOVA_PASS<br>openstack-config --set /etc/nova/nova.conf DEFAULT my_ip 172.16.100.29   ###替换自己IP<br>openstack-config --set /etc/nova/nova.conf DEFAULT use_neutron True<br>openstack-config --set /etc/nova/nova.conf DEFAULT firewall_driver nova.virt.firewall.NoopFirewallDriver<br>openstack-config --set /etc/nova/nova.conf vnc enabled True<br>openstack-config --set /etc/nova/nova.conf vnc vncserver_listen 0.0.0.0<br>openstack-config --set /etc/nova/nova.conf vnc vncserver_proxyclient_address &#x27;$my_ip&#x27;<br>openstack-config --set /etc/nova/nova.conf vnc novncproxy_base_url http://172.16.100.28:6080/vnc_auto.html<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">##服务器组件监听所有的 IP 地址，而代理组件仅仅监听计算节点管理网络接口的 IP 地址。基本的 URL 指示您可以使用 web 浏览器访问位于该计算节点上实例的远程控制台的位置。</span></span><br>openstack-config --set /etc/nova/nova.conf glance api_servers http://controller:9292<br>openstack-config --set /etc/nova/nova.conf oslo_concurrency lock_path /var/lib/nova/tmp<br>openstack-config --set /etc/nova/nova.conf libvirt cpu_mode none<br>openstack-config --set /etc/nova/nova.conf libvirt virt_type qemu<br></code></pre></div></td></tr></table></figure>

<h4 id="启动服务-2"><a href="#启动服务-2" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl enable libvirtd.service openstack-nova-compute.service<br>systemctl start libvirtd.service openstack-nova-compute.service<br></code></pre></div></td></tr></table></figure>

<h3 id="查看nova是否正常"><a href="#查看nova是否正常" class="headerlink" title="查看nova是否正常"></a>查看nova是否正常</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# nova service-list<br>+----+------------------+------------+----------+---------+-------+----------------------------+-----------+<br>| Id | Binary           | Host       | Zone     | Status  | State | Updated_at                 | Disabled Reason |<br>+----+------------------+------------+----------+---------+-------+----------------------------+-----------+<br>| 1  | nova-consoleauth | controller | internal | enabled | up    | 2021-11-23T12:50:21.000000 | -               |<br>| 2  | nova-conductor   | controller | internal | enabled | up    | 2021-11-23T12:50:22.000000 | -               |<br>| 3  | nova-scheduler   | controller | internal | enabled | up    | 2021-11-23T12:50:21.000000 | -               |<br>| 9  | nova-compute     | compute    | nova     | enabled | up    | 2021-11-23T12:50:25.000000 | -               |<br>+----+------------------+------------+----------+---------+-------+----------------------------+-----------+<br><br></code></pre></div></td></tr></table></figure>

<h2 id="Neutron网络服务"><a href="#Neutron网络服务" class="headerlink" title="Neutron网络服务"></a>Neutron网络服务</h2><p>neutron-serverT端(9696)	api:接受和响应外部的网络管理请求</p>
<p>neutron-linuxbridge-agent :	负责创建桥接网卡</p>
<p>neutron-dhcp-agent:		负责分配IP</p>
<p>neutron-metadata-agent:	配合nova-metadata-api实现虚拟机的定制化操作</p>
<p>L3-agent：				实现三层网络vxlan(网络层)</p>
<h3 id="controller-4"><a href="#controller-4" class="headerlink" title="controller"></a>controller</h3><h4 id="在控制节点创建neutron服务数据库-controller"><a href="#在控制节点创建neutron服务数据库-controller" class="headerlink" title="在控制节点创建neutron服务数据库(controller)"></a>在控制节点创建neutron服务数据库(controller)</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.登录mysql数据库<br>	mysql -u root -p000000<br>b.创建neutron数据库<br>	CREATE DATABASE neutron;<br>c.创建neutron数据库用户，使其可以对neutron数据库有完全控制权限<br>	GRANT ALL PRIVILEGES ON neutron.* TO &#x27;neutron&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;NEUTRON_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON neutron.* TO &#x27;neutron&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;NEUTRON_DBPASS&#x27;;<br>d.退出数据库<br>	exit<br></code></pre></div></td></tr></table></figure>

<h4 id="在keystone创建系统用户-glance-nova-neutron-关联角色"><a href="#在keystone创建系统用户-glance-nova-neutron-关联角色" class="headerlink" title="在keystone创建系统用户(glance, nova, neutron)关联角色"></a>在keystone创建系统用户(glance, nova, neutron)关联角色</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack user create --domain default --password NEUTRON_PASS neutron<br>openstack role add --project service --user neutron admin<br></code></pre></div></td></tr></table></figure>

<h4 id="在keystone上创建服务和注册api-1"><a href="#在keystone上创建服务和注册api-1" class="headerlink" title="在keystone上创建服务和注册api"></a>在keystone上创建服务和注册api</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"> openstack service create --name neutron \<br>  --description &quot;OpenStack Networking&quot; network<br>openstack endpoint create --region RegionOne \<br>  network public http://controller:9696<br>openstack endpoint create --region RegionOne \<br>  network internal http://controller:9696<br>openstack endpoint create --region RegionOne \<br>  network admin http://controller:9696<br></code></pre></div></td></tr></table></figure>

<h4 id="安装服务相应软件包"><a href="#安装服务相应软件包" class="headerlink" title="安装服务相应软件包"></a>安装服务相应软件包</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum  -y install openstack-neutron openstack-neutron-ml2 openstack-neutron-linuxbridge ebtables<br></code></pre></div></td></tr></table></figure>

<h4 id="修改配置文件-4"><a href="#修改配置文件-4" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p><strong>配置服务组件</strong></p>
<p><strong>a：&#x2F;etc&#x2F;neutron&#x2F;neutron.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/neutron.conf&#123;,.bak&#125;<br>grep &#x27;^[a-z\[]&#x27; /etc/neutron/neutron.conf.bak &gt;/etc/neutron/neutron.conf<br><br>openstack-config --set /etc/neutron/neutron.conf database connection mysql+pymysql://neutron:NEUTRON_DBPASS@controller/neutron<br>openstack-config --set /etc/neutron/neutron.conf DEFAULT core_plugin ml2<br>openstack-config --set /etc/neutron/neutron.conf DEFAULT service_plugins  <br>openstack-config --set /etc/neutron/neutron.conf DEFAULT  rpc_backend rabbit<br>openstack-config --set /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_host controller<br>openstack-config --set /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_userid openstack<br>openstack-config --set /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_password RABBIT_PASS<br>openstack-config --set /etc/neutron/neutron.conf DEFAULT auth_strategy keystone<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_type password<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_domain_name default<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken user_domain_name default<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_name service<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken username neutron<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken password NEUTRON_PASS<br>openstack-config --set /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_status_changes True<br>openstack-config --set /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_data_changes True<br>openstack-config --set /etc/neutron/neutron.conf  nova auth_url http://controller:35357<br>openstack-config --set /etc/neutron/neutron.conf  nova auth_type password<br>openstack-config --set /etc/neutron/neutron.conf  nova project_domain_name default<br>openstack-config --set /etc/neutron/neutron.conf  nova user_domain_name default<br>openstack-config --set /etc/neutron/neutron.conf  nova region_name RegionOne<br>openstack-config --set /etc/neutron/neutron.conf  nova project_name service<br>openstack-config --set /etc/neutron/neutron.conf  nova username nova<br>openstack-config --set /etc/neutron/neutron.conf  nova password NOVA_PASS<br>openstack-config --set /etc/neutron/neutron.conf  oslo_concurrency lock_path /var/lib/neutron/tmp<br></code></pre></div></td></tr></table></figure>

<p><strong>配置 Modular Layer 2 (ML2) 插件</strong></p>
<p><strong>b: &#x2F;etc&#x2F;neutron&#x2F;plugins&#x2F;ml2&#x2F;ml2_conf.ini</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/plugins/ml2/ml2_conf.ini&#123;,.bak&#125;<br>grep &#x27;^[a-z\[]&#x27; /etc/neutron/plugins/ml2/ml2_conf.ini.bak &gt;/etc/neutron/plugins/ml2/ml2_conf.ini<br><br>openstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 type_drivers flat,vlan<br>openstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 tenant_network_types <br>openstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 mechanism_drivers linuxbridge<br>openstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 extension_drivers port_security<br>openstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_flat flat_networks provider<br>openstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup enable_ipset True<br></code></pre></div></td></tr></table></figure>

<p><strong>配置Linuxbridge代理</strong></p>
<p><strong>c: &#x2F;etc&#x2F;neutron&#x2F;plugins&#x2F;ml2&#x2F;linuxbridge_agent.ini</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/plugins/ml2/linuxbridge_agent.ini&#123;,.bak&#125;<br>grep &#x27;^[a-Z\[]&#x27; /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak &gt;/etc/neutron/plugins/ml2/linuxbridqe_agent.ini<br><br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings provider:eth0 ###替换自己的网卡名称<br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan False<br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group True<br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver neutron.agent.linux.iptables_firewall.IptablesFirewallDriver<br></code></pre></div></td></tr></table></figure>

<p><strong>配置DHCP代理</strong></p>
<p><strong>d: &#x2F;etc&#x2F;neutron&#x2F;dhcp_agent.ini</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/dhcp_agent.ini&#123;,.bak&#125;<br>grep &#x27;^[a-Z\[]&#x27;  /etc/neutron/dhcp_agent.ini.bak &gt;/etc/neutron/dhcp_agent.ini<br><br>openstack-config --set /etc/neutron/dhcp_agent.ini DEFAULT interface_driver   neutron.agent.linux.interface.BridgeInterfaceDriver<br>openstack-config --set /etc/neutron/dhcp_agent.ini DEFAULT dhcp_driver   neutron.agent.linux.dhcp.Dnsmasq<br>openstack-config --set /etc/neutron/dhcp_agent.ini DEFAULT enable_isolated_metadata   True<br></code></pre></div></td></tr></table></figure>

<p><strong>配置元数据代理</strong></p>
<p><strong>e：&#x2F;etc&#x2F;neutron&#x2F;metadata_agent.ini</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/metadata_agent.ini&#123;,.bak&#125;<br>grep -EV &#x27;^$|#&#x27; /etc/neutron/metadata_agent.ini.bak &gt; /etc/neutron/metadata_agent.ini<br><br>openstack-config --set /etc/neutron/metadata_agent.ini DEFAULT nova_metadata_ip controller<br>openstack-config --set /etc/neutron/metadata_agent.ini DEFAULT metadata_proxy_shared_secret METADATA_SECRET<br></code></pre></div></td></tr></table></figure>

<p><strong>添加控制节点网络服务</strong></p>
<p><strong>f：&#x2F;etc&#x2F;nova&#x2F;nova.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack-config --set  /etc/nova/nova.conf neutron url    http://controller:9696<br>openstack-config --set  /etc/nova/nova.conf neutron auth_url   http://controller:35357<br>openstack-config --set  /etc/nova/nova.conf neutron auth_type  password<br>openstack-config --set  /etc/nova/nova.conf neutron project_domain_name    default<br>openstack-config --set  /etc/nova/nova.conf neutron user_domain_name    default<br>openstack-config --set  /etc/nova/nova.conf neutron region_name    RegionOne<br>openstack-config --set  /etc/nova/nova.conf neutron project_name    service<br>openstack-config --set  /etc/nova/nova.conf neutron username    neutron<br>openstack-config --set  /etc/nova/nova.conf neutron password    NEUTRON_PASS<br>openstack-config --set  /etc/nova/nova.conf neutron service_metadata_proxy    True<br>openstack-config --set  /etc/nova/nova.conf neutron metadata_proxy_shared_secret    METADATA_SECRET<br></code></pre></div></td></tr></table></figure>

<h4 id="同步neutron数据库"><a href="#同步neutron数据库" class="headerlink" title="同步neutron数据库"></a><strong>同步neutron数据库</strong></h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">ln -s /etc/neutron/plugins/ml2/ml2_conf.ini /etc/neutron/plugin.ini<br>su -s /bin/sh -c &quot;neutron-db-manage --config-file /etc/neutron/neutron.conf \<br>  --config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head&quot; neutron<br></code></pre></div></td></tr></table></figure>

<!--可以ok即成功-->

<!--同步后进入数据库查看neutron库是否有数据-->

<!--忽略警告-->

<h4 id="启动服务-3"><a href="#启动服务-3" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl restart openstack-nova-api.service<br>systemctl enable neutron-server.service \<br>  neutron-linuxbridge-agent.service neutron-dhcp-agent.service \<br>  neutron-metadata-agent.service<br>systemctl start neutron-server.service \<br>  neutron-linuxbridge-agent.service neutron-dhcp-agent.service \<br>  neutron-metadata-agent.service<br></code></pre></div></td></tr></table></figure>

<h3 id="compute-4"><a href="#compute-4" class="headerlink" title="compute"></a>compute</h3><h4 id="在计算节点安装组件-compute"><a href="#在计算节点安装组件-compute" class="headerlink" title="在计算节点安装组件(compute)"></a>在计算节点安装组件(compute)</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-neutron-linuxbridge ebtables ipset<br></code></pre></div></td></tr></table></figure>

<h4 id="修改配置文件-5"><a href="#修改配置文件-5" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p><strong>a.&#x2F;etc&#x2F;neutron&#x2F;neutron.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/neutron.conf&#123;,.bak&#125;<br>grep &#x27;^[a-Z\[]&#x27; /etc/neutron/neutron.conf.bak &gt;/etc/neutron/neutron.conf<br><br>openstack-config --set /etc/neutron/neutron.conf DEFAULT rpc_backend    rabbit<br>openstack-config --set /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_host    controller<br>openstack-config --set /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_userid    openstack<br>openstack-config --set /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_password RABBIT_PASS<br>openstack-config --set /etc/neutron/neutron.conf DEFAULT auth_strategy    keystone<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_type    password<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_domain_name  default<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken user_domain_name    default<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_name    service<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken username    neutron<br>openstack-config --set /etc/neutron/neutron.conf keystone_authtoken password    NEUTRON_PASS<br>openstack-config --set /etc/neutron/neutron.conf oslo_concurreny lock_path    /var/lib/neutron/tmp<br></code></pre></div></td></tr></table></figure>

<p><strong>配置Linuxbridge代理</strong></p>
<p><strong>b: &#x2F;etc&#x2F;neutron&#x2F;plugins&#x2F;ml2&#x2F;linuxbridge_agent.ini</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/neutron/plugins/ml2/linuxbridge_agent.ini&#123;,.bak&#125;<br>grep &#x27;^[a-Z\[]&#x27; /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak &gt;/etc/neutron/plugins/ml2/linuxbridqe_agent.ini<br><br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings provider:eth0  ###替换自己的网卡名称<br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan False<br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group True<br>openstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver neutron.agent.linux.iptables_firewall.IptablesFirewallDriver<br></code></pre></div></td></tr></table></figure>

<p><strong>添加计算节点网络服务</strong></p>
<p><strong>c：&#x2F;etc&#x2F;nova&#x2F;nova.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack-config --set  /etc/nova/nova.conf neutron url    http://controller:9696<br>openstack-config --set  /etc/nova/nova.conf neutron auth_url    http://controller:35357<br>openstack-config --set  /etc/nova/nova.conf neutron auth_type    password<br>openstack-config --set  /etc/nova/nova.conf neutron project_domain_name    default<br>openstack-config --set  /etc/nova/nova.conf neutron user_domain_name    default<br>openstack-config --set  /etc/nova/nova.conf neutron region_name    RegionOne<br>openstack-config --set  /etc/nova/nova.conf neutron project_name    service<br>openstack-config --set  /etc/nova/nova.conf neutron username    neutron<br>openstack-config --set  /etc/nova/nova.conf neutron password    NEUTRON_PASS<br></code></pre></div></td></tr></table></figure>

<h4 id="启动服务-4"><a href="#启动服务-4" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">重新启动计算服务：<br>	systemctl restart openstack-nova-compute.service<br>启动Linuxbridge代理并配置它开机自启动：<br>	systemctl enable neutron-linuxbridge-agent.service<br>	systemctl start neutron-linuxbridge-agent.service<br></code></pre></div></td></tr></table></figure>

<h2 id="Dashboard服务"><a href="#Dashboard服务" class="headerlink" title="Dashboard服务"></a>Dashboard服务</h2><p>(根据情况确定安装控制节点还是计算节点）</p>
<blockquote>
<p>此次安装在compute上</p>
</blockquote>
<h3 id="安装openstack-dashboard"><a href="#安装openstack-dashboard" class="headerlink" title="安装openstack-dashboard"></a>安装openstack-dashboard</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-dashboard<br></code></pre></div></td></tr></table></figure>

<h3 id="修改配置文件-6"><a href="#修改配置文件-6" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p><strong>&#x2F;etc&#x2F;openstack-dashboard&#x2F;local_settings</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">在 controller 节点上配置仪表盘以使用 OpenStack 服务</span><br>OPENSTACK_HOST = &quot;controller&quot;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">允许所有主机访问仪表板</span><br>ALLOWED_HOSTS = [&#x27;*&#x27;, ]<br><span class="hljs-meta prompt_">#</span><span class="language-bash">配置 memcached 会话存储服务</span><br>CACHES = &#123;<br>	 	 &#x27;default&#x27;: &#123;<br>        		&#x27;BACKEND&#x27;: &#x27;django.core.cache.backends.memcached.MemcachedCache&#x27;,<br> 	  	 	     &#x27;LOCATION&#x27;: &#x27;controller:11211&#x27;,<br>			   &#125;<br>&#125;<br>SESSION_ENGINE = &#x27;django.contrib.sessions.backends.cache&#x27;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">启用第3版认证API</span><br>OPENSTACK_KEYSTONE_URL = &quot;http://%s:5000/v3&quot; % OPENSTACK_HOST<br><span class="hljs-meta prompt_">#</span><span class="language-bash">启用对域的支持</span><br>OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = True<br><span class="hljs-meta prompt_">#</span><span class="language-bash">配置API版本</span><br>OPENSTACK_API_VERSIONS = &#123;<br>		   &quot;identity&quot;: 3,<br>	 	   &quot;image&quot;: 2,<br>	   	   &quot;volume&quot;: 2,<br>		&#125;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">通过仪表盘创建用户时的默认域配置为 default</span><br>OPENSTACK_KEYSTONE_DEFAULT_DOMAIN = &quot;default&quot;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">通过仪表盘创建的用户默认角色配置为 user</span><br>OPENSTACK_KEYSTONE_DEFAULT_ROLE = &quot;user&quot;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">如果您选择网络参数1，禁3层网络服务：</span><br>OPENSTACK_NEUTRON_NETWORK = &#123;<br>	    ...<br>&#x27;enable_router&#x27;: False,<br>&#x27;enable_quotas&#x27;: False,<br>&#x27;enable_distributed_router&#x27;: False,<br>&#x27;enable_ha_router&#x27;: False,<br>&#x27;enable_lb&#x27;: False,<br>&#x27;enable_firewall&#x27;: False,<br>&#x27;enable_vpn&#x27;: False,<br>&#x27;enable_fip_topology_check&#x27;: False,<br>		&#125;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">可以选择性地配置时区：</span><br>TIME_ZONE = &quot;Asia/Shanghai&quot;<br></code></pre></div></td></tr></table></figure>

<h3 id="启动服务-5"><a href="#启动服务-5" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl restart httpd.service<br></code></pre></div></td></tr></table></figure>

<h3 id="控制节点"><a href="#控制节点" class="headerlink" title="控制节点"></a>控制节点</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl restart memcached.service<br></code></pre></div></td></tr></table></figure>

<p>###如服务无法启动,在&#x2F;etc&#x2F;httpd&#x2F;conf.d&#x2F;openstack-dashboard.conf文件下添加以下字段###</p>
<p>​				WSGIApplicationGroup %{GLOBAL}</p>
<h2 id="Cinder块存储服务"><a href="#Cinder块存储服务" class="headerlink" title="Cinder块存储服务"></a>Cinder块存储服务</h2><p>cinder-volume LVM,nfs,gfs,ceph</p>
<p>cinder-api:				接收外部的api请求</p>
<p>cinder-volume:		提供存储空间</p>
<p>cinder-scheduler	调度器,决定将要分配的空间由哪一个cinder-volume提供</p>
<p>cinder-backup		备份存储</p>
<h3 id="controller-5"><a href="#controller-5" class="headerlink" title="controller"></a>controller</h3><h4 id="在控制节点创建Cinder服务数据库-controller"><a href="#在控制节点创建Cinder服务数据库-controller" class="headerlink" title="在控制节点创建Cinder服务数据库(controller)"></a>在控制节点创建Cinder服务数据库(controller)</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a.登录mysql数据库<br>	mysql -u root -p000000<br>b.创建cinder数据库<br>	CREATE DATABASE cinder;<br>c.创建cinder数据库用户，使其可以对cinder数据库有完全控制权限<br>	GRANT ALL PRIVILEGES ON cinder.* TO &#x27;cinder&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;CINDER_DBPASS&#x27;;<br>	GRANT ALL PRIVILEGES ON cinder.* TO &#x27;cinder&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;CINDER_DBPASS&#x27;;<br>d.退出数据库<br>	exit<br></code></pre></div></td></tr></table></figure>

<h4 id="在keystone创建系统用户-glance-nova-neutron-cinder-关联角色"><a href="#在keystone创建系统用户-glance-nova-neutron-cinder-关联角色" class="headerlink" title="在keystone创建系统用户(glance, nova, neutron,cinder)关联角色"></a>在keystone创建系统用户(glance, nova, neutron,cinder)关联角色</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack user create --domain default --password CINDER_PASS cinder<br>openstack role add --project service --user cinder admin<br></code></pre></div></td></tr></table></figure>

<h4 id="在keystone上创建服务和注册api-2"><a href="#在keystone上创建服务和注册api-2" class="headerlink" title="在keystone上创建服务和注册api"></a>在keystone上创建服务和注册api</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"> openstack service create --name cinder \<br>  --description &quot;OpenStack Block Storage&quot; volume<br>openstack service create --name cinderv2 \<br>  --description &quot;OpenStack Block Storage&quot; volumev2<br>  <br>openstack endpoint create --region RegionOne \<br>  volume public http://controller:8776/v1/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  volume internal http://controller:8776/v1/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  volume admin http://controller:8776/v1/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  volumev2 public http://controller:8776/v2/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  volumev2 internal http://controller:8776/v2/%\(tenant_id\)s<br>openstack endpoint create --region RegionOne \<br>  volumev2 admin http://controller:8776/v2/%\(tenant_id\)s<br></code></pre></div></td></tr></table></figure>

<h4 id="安装服务相应软件包-1"><a href="#安装服务相应软件包-1" class="headerlink" title="安装服务相应软件包"></a>安装服务相应软件包</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-cinder<br></code></pre></div></td></tr></table></figure>

<h4 id="修改配置文件-7"><a href="#修改配置文件-7" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p><strong>&#x2F;etc&#x2F;cinder&#x2F;cinder.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/cinder/cinder.conf&#123;,.bak&#125;<br>grep -Ev &#x27;^$|#&#x27; /etc/cinder/cinder.conf.bak &gt;/etc/cinder/cinder.conf<br><br>openstack-config --set /etc/cinder/cinder.conf database connection    mysql+pymysql://cinder:CINDER_DBPASS@controller/cinder<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT rpc_backend    rabbit<br>openstack-config --set /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_host    controller<br>openstack-config --set /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_userid    openstack<br>openstack-config --set /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_password    RABBIT_PASS<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT auth_strategy    keystone<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_uri    http://controller:5000<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_url    http://controller:35357<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken memcached_servers    controller:11211<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_type    password<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_domain_name    default<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken user_domain_name    default<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_name    service<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken username    cinder<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken password    CINDER_PASS<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT my_ip  172.16.100.28 ###替换自己IP<br>openstack-config --set /etc/cinder/cinder.conf oslo_concurrency lock_path    /var/lib/cinder/tmp<br></code></pre></div></td></tr></table></figure>

<h4 id="同步cinder数据库"><a href="#同步cinder数据库" class="headerlink" title="同步cinder数据库"></a>同步cinder数据库</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">su -s /bin/sh -c &quot;cinder-manage db sync&quot; cinder<br></code></pre></div></td></tr></table></figure>

<!--同步后进入数据库查看cinder库是否有数据-->

<!--忽略警告-->

<p>修改nova配置文件</p>
<p><strong>&#x2F;etc&#x2F;nova&#x2F;nova.conf</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arduino">openstack-config --set /etc/cinder/cinder.conf cinder os_region_name  RegionOne<br></code></pre></div></td></tr></table></figure>

<h4 id="启动服务-6"><a href="#启动服务-6" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl restart openstack-nova-api.service<br>systemctl enable openstack-cinder-api.service openstack-cinder-scheduler.service<br>systemctl start openstack-cinder-api.service openstack-cinder-scheduler.service<br></code></pre></div></td></tr></table></figure>

<h3 id="compute-5"><a href="#compute-5" class="headerlink" title="compute"></a>compute</h3><h4 id="在计算节点安装存储节点-compute"><a href="#在计算节点安装存储节点-compute" class="headerlink" title="在计算节点安装存储节点(compute)"></a>在计算节点安装存储节点(compute)</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">安装支持的工具包</span><br>yum -y install lvm2<br>systemctl enable lvm2-lvmetad.service<br>systemctl start lvm2-lvmetad.service<br></code></pre></div></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">在计算节点新建一块硬盘<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">##如果在VM添加的硬盘没有扫描出来,用以下命令</span></span><br>echo &#x27;- - -&#x27; &gt;/sys/class/scsi_host/host&#123;0,1,2&#125;/scan<br><br>[root@compute ~]# lsblk<br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sr0              11:0    1 1024M  0 rom  <br>vda             252:0    0   80G  0 disk <br>├─vda1          252:1    0    1G  0 part /boot<br>└─vda2          252:2    0   79G  0 part <br>  ├─centos-root 253:0    0 49.9G  0 lvm  /<br>  ├─centos-swap 253:1    0  4.8G  0 lvm  [SWAP]<br>  └─centos-home 253:2    0 24.3G  0 lvm  /home<br>vdb             252:16   0   80G  0 disk  ###新添加的硬盘<br></code></pre></div></td></tr></table></figure>

<h4 id="创建LVM-物理卷"><a href="#创建LVM-物理卷" class="headerlink" title="创建LVM 物理卷"></a>创建LVM 物理卷</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]#  pvcreate /dev/vdb<br>  Physical volume &quot;/dev/vdb&quot; successfully created.<br></code></pre></div></td></tr></table></figure>

<h4 id="创建-LVM-卷组-cinder-volumes"><a href="#创建-LVM-卷组-cinder-volumes" class="headerlink" title="创建 LVM 卷组 cinder-volumes"></a>创建 LVM 卷组 cinder-volumes</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@compute ~]# vgcreate cinder-volumes /dev/vdb<br>  Volume group &quot;cinder-volumes&quot; successfully created<br></code></pre></div></td></tr></table></figure>

<h4 id="添加一个过滤器-只有实例可以访问块存储卷组"><a href="#添加一个过滤器-只有实例可以访问块存储卷组" class="headerlink" title="添加一个过滤器(只有实例可以访问块存储卷组)"></a>添加一个过滤器(只有实例可以访问块存储卷组)</h4><p><strong>&#x2F;etc&#x2F;lvm&#x2F;lvm.conf</strong> </p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">##大概文件130行左右</span></span><br>filter = [ &quot;a/vdb/&quot;, &quot;r/.*/&quot;]<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#####多盘######filter = [ &quot;a/vdb/&quot;, &quot;a/vdc/&quot;, &quot;r/.*/&quot;]</span></span><br></code></pre></div></td></tr></table></figure>

<h4 id="安装服务相应软件包-2"><a href="#安装服务相应软件包-2" class="headerlink" title="安装服务相应软件包"></a>安装服务相应软件包</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install openstack-cinder targetcli python-keystone<br></code></pre></div></td></tr></table></figure>

<h4 id="修改配置文件-8"><a href="#修改配置文件-8" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p><strong>&#x2F;etc&#x2F;cinder&#x2F;cinder.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cp /etc/cinder/cinder.conf&#123;,.bak&#125;<br>grep -Ev &#x27;^$|#&#x27; /etc/cinder/cinder.conf.bak &gt;/etc/cinder/cinder.conf<br><br>openstack-config --set /etc/cinder/cinder.conf database connection mysql+pymysql://cinder:CINDER_DBPASS@controller/cinder<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT rpc_backend rabbit<br>openstack-config --set /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_host controller<br>openstack-config --set /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_userid openstack<br>openstack-config --set /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_password RABBIT_PASS<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT auth_strategy keystone<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_uri http://controller:5000<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_url http://controller:35357<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken memcached_servers controller:11211<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_type password<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_domain_name default<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken user_domain_name default<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_name service<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken username cinder<br>openstack-config --set /etc/cinder/cinder.conf keystone_authtoken password CINDER_PASS<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT my_ip 172.16.10.29<br>openstack-config --set /etc/cinder/cinder.conf lvm volume_driver cinder.volume.drivers.lvm.LVMVolumeDriver<br>openstack-config --set /etc/cinder/cinder.conf lvm volume_group cinder-volumes<br>openstack-config --set /etc/cinder/cinder.conf lvm iscsi_protocol  iscsi<br>openstack-config --set /etc/cinder/cinder.conf lvm iscsi_helper lioadm<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT enabled_backends lvm<br>openstack-config --set /etc/cinder/cinder.conf DEFAULT glance_api_servers http://controller:9292<br>openstack-config --set /etc/cinder/cinder.conf oslo_concurrency lock_path /var/lib/cinder/tmp<br></code></pre></div></td></tr></table></figure>

<h4 id="启动服务-7"><a href="#启动服务-7" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">systemctl enable openstack-cinder-volume.service target.service<br>systemctl start openstack-cinder-volume.service target.service<br></code></pre></div></td></tr></table></figure>

<h4 id="在controller检查是否成功"><a href="#在controller检查是否成功" class="headerlink" title="在controller检查是否成功"></a>在controller检查是否成功</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@controller ~]# cinder service-list<br>+------------------+-------------+------+---------+-------+----------------------------+-----------------+<br>|      Binary      |     Host    | Zone |  Status | State |         Updated_at         | Disabled Reason |<br>+------------------+-------------+------+---------+-------+----------------------------+-----------------+<br>| cinder-scheduler |  controller | nova | enabled |   up  | 2021-11-24T02:01:16.000000 |        -        |<br>|  cinder-volume   | compute@lvm | nova | enabled |   up  | 2021-11-24T02:01:23.000000 |        -        |<br>+------------------+-------------+------+---------+-------+----------------------------+-----------------+<br></code></pre></div></td></tr></table></figure>

<h2 id="启动一个实例"><a href="#启动一个实例" class="headerlink" title="启动一个实例"></a>启动一个实例</h2><h3 id="1-创建网络"><a href="#1-创建网络" class="headerlink" title="1.创建网络"></a>1.创建网络</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">neutron net-create --shared --provider:physical_network provider  --provider:network_type flat zzz<br>neutron subnet-create --name  zzz123\<br>	  --allocation-pool start=172.16.100.101,end=172.16.100.250 \<br>	  --dns-nameserver 114.114.114.114 --gateway 172.16.100.254 \<br> 	  zzz 172.16.100.0/24<br></code></pre></div></td></tr></table></figure>

<h3 id="2-创建云主机的硬件配置方案"><a href="#2-创建云主机的硬件配置方案" class="headerlink" title="2.创建云主机的硬件配置方案"></a>2.创建云主机的硬件配置方案</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">openstack flavor create --id 0 --vcpus 1 --ram 64 --disk 1 m1.nano<br></code></pre></div></td></tr></table></figure>

<h3 id="3-创建密钥对"><a href="#3-创建密钥对" class="headerlink" title="3.创建密钥对"></a>3.创建密钥对</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">ssh-keygen -q -N &quot;&quot; -f ~/.ssh/id_rsa<br>openstack keypair create --public-key ~/.ssh/id_rsa.pub mykey<br>验证是否添加:  openstack keypair list<br></code></pre></div></td></tr></table></figure>

<h3 id="4-创建安全组规则"><a href="#4-创建安全组规则" class="headerlink" title="4.创建安全组规则"></a>4.创建安全组规则</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">允许 ICMP (ping)：<br>openstack security group rule create --proto icmp default<br>允许安全 shell (SSH) 的访问：<br>openstack security group rule create --proto tcp --dst-port 22 default<br></code></pre></div></td></tr></table></figure>

<h3 id="5-启动一个实例"><a href="#5-启动一个实例" class="headerlink" title="5.启动一个实例"></a>5.启动一个实例</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">查看网络id:  neutron net-list<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">##网络id=PROVIDER_NET_ID</span></span><br>创建实例:<br>openstack server create --flavor m1.nano --image cirros \<br>  --nic net-id=PROVIDER_NET_ID --security-group default \<br>  --key-name mykey provider-instance<br>  <br><span class="hljs-meta prompt_">  </span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">##查看已创建实例###</span></span><br>[root@controller ~]# openstack server list<br>+--------------------------------------+-------------------+--------+--------------------+<br>| ID                                   | Name              | Status | Networks           |<br>+--------------------------------------+-------------------+--------+--------------------+<br>| f6fa8d1a-13e7-46c9-b5e3-78cfdc3497d5 | provider-instance | ACTIVE | zzz=172.16.100.102 |<br>+--------------------------------------+-------------------+--------+--------------------+<br></code></pre></div></td></tr></table></figure>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Linux/">Linux</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/openstack-M/">openstack-M</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明来自<a target="_blank" href="https://git.curtain-z.cn/" rel="nofollow noopener noopener">NoteBook</a>！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/04/17/Linux%E6%89%A9%E5%AE%B9%E6%A0%B9%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Linux扩容根磁盘空间</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/04/17/docker/">
                        <span class="hidden-mobile">docker</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        赣ICP备2021001969号
      </a>
    </span>
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
